sources:
  - name: LogicaHealth Sandbox v3
    handler:
      fhir:
        endpoint: https://api.logicahealth.org/PatientCloud10STU3/open

additionalTypeDefs: |
  enum PeriodInterval {
    MONTH
    WEEK
  }
  input TimeInterval {
    interval: PeriodInterval!
    limit: Int
  }
  enum OrderDirection {
    ASC
    DESC
  }
  type TinyMedicationResponse {
    MedicationName: String 
    Instructions: String
    Fields(fields: [String]): JSON
  }
  type PeriodStat {
    AVGMeanValue: Float
    DateNumber: String
    DateLabel: String
  }
  type AllTimeStat {
    BestValue: Float
    EIGHTYPCBestValue: Float
    FIFTYPCBestValue: Float
    AVGMeanValue: Float
  }
  type TinyPeakFlowResponse {
    statsForPeriod(order: OrderDirection): [PeriodStat]
    statsAllTime: AllTimeStat
  }
  extend type Query {
    TinyMedicationRequest(PatientID: String!, dates: String): [TinyMedicationResponse]
    TinyPeakFlowStats(PatientID: String!, date_range: TimeInterval!): TinyPeakFlowResponse
  }
additionalResolvers:
  - ./src/tinyMedicationRequest.js
  - ./src/tinyPeakFlowStats.js

serve:
  exampleQuery: ./example-queries/*.graphql
  port: ${PORT?}
  cors:
    origin:
      - "*"
    allowedHeaders:
      - "Origin"
      - "Content-Type"
      - "Authorization"
      - "Partner-Company"
      - "X-Requested-With"
    exposedHeaders:
      - "access-control-allow-headers"
      - "access-control-allow-methods"
      - "access-control-allow-origin"
      - "content-type"
